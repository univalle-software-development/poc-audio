# Project File Descriptions

This file provides a brief overview of the core files and configuration files within the Next.js + Convex Chat App project.

## Next.js App & Pages

- **`app/layout.tsx`**: The main root layout for the Next.js application using the App Router. It sets up the HTML structure, includes global styles, fonts, providers, and renders common components like Navbar and Footer.
- **`app/page.tsx`**: (Not provided in context, but inferred from `README.md`) The main page component for the root route (`/`). It likely renders the primary `Chat` component.
- **`app/providers.tsx`**: (Not provided in context, but inferred from `layout.tsx`) A client component likely responsible for wrapping the application with context providers, such as the `ConvexProvider`, `ThemeProvider`, etc.
- **`app/globals.css`**: Contains global CSS styles and Tailwind CSS base/utility layer definitions.

## Components

- **`components/chat.tsx`**: The core UI component for the chat interface. Manages chat state via `useConvexChat`, handles user input, and renders the list of messages using `ChatMessage`.
- **`components/chat-message.tsx`**: (Not provided in context, but inferred from `chat.tsx` and `README.md`) Renders individual chat messages, potentially differentiating between user and assistant messages.
- **`components/convex-chat-provider.tsx`**: (Not provided in context, but inferred from `chat.tsx` and `README.md`) Provides the `ConvexChatProvider` context and the `useConvexChat` hook, integrating Convex state management with the Vercel AI SDK (`useChat`).
- **`components/navbar.tsx`**: (Not provided in context, but inferred from `layout.tsx`) Renders the application's navigation bar.
- **`components/footer.tsx`**: (Not provided in context, but inferred from `layout.tsx`) Renders the application's footer.
- **`components/ui/`**: (Directory structure inferred from `components.json`) Contains UI components built using shadcn/ui (e.g., `toast.tsx`, `button.tsx`, etc.). Specific files not provided in context.
  - **`components/ui/toast.tsx`**: (Not provided in context, but inferred from `hooks/use-toast.ts`) The UI component for displaying toast notifications.

## Convex Backend (`convex/`)

- **`convex/schema.ts`**: Defines the database schema for Convex, specifying tables (`messages`, `modelPreferences`, `chat_history`) and their fields, types, and indexes.
- **`convex/chat.ts`**: Contains the `archiveChat` mutation, responsible for moving messages from the main `messages` table to the `chat_history` table and deleting the originals.
- **`convex/directMessages.ts`**: Defines the `saveAIResponse` internal mutation, used specifically to save AI-generated responses directly into the `messages` table.
- **`convex/init.ts`**: Contains the `setupInitialData` internal mutation, intended to be run (e.g., via `--preview-run` in Vercel) to seed the database with initial data if it's empty.
- **`convex/messages.ts`**: Defines public Convex functions for message operations: `create` (mutation to add a new message) and `list` (query to fetch messages for a user or chat), and `getThread` (query to fetch messages based on parentId).
- **`convex/modelPreferences.ts`**: Defines functions (`getPreference`, `setPreference`) to manage user/chat preferences for which AI model to use. Includes constants for valid models.
- **`convex/multiModelAI.ts`**: Contains the core `chat` action that receives messages, prepares them (adds system prompt), selects the AI model (currently hardcoded to OpenAI), calls the appropriate handler, and saves the response using `internal.directMessages.saveAIResponse`. Includes error handling and fallback logic.
- **`convex/openai.ts`**: Re-exports `chat` and `streamChat` actions from `convex/useOpenAI.ts` for potential backward compatibility or alternative usage patterns.
- **`convex/useOpenAI.ts`**: Defines the primary Convex actions (`chat`, `streamChat`) for interacting with the OpenAI API (specifically `gpt-3.5-turbo`). Handles API key setup and basic error handling for OpenAI calls.
- **`convex/_generated/`**: (Directory structure inferred) Contains code automatically generated by the Convex CLI based on the schema and functions defined in the `convex/` directory. Includes typed API objects (`api`, `internal`) and data model types (`Doc`, `Id`). **Should not be edited manually.**

## Hooks

- **`hooks/use-toast.ts`**: A custom hook (inspired by react-hot-toast) for managing and displaying toast notifications using the shadcn/ui `Toast` component. Defines the state management logic (reducer, dispatch) for toasts.

## Library/Utilities (`lib/`)

- **`lib/utils.ts`**: Contains utility functions, notably the `cn` function which merges Tailwind CSS classes using `clsx` and `tailwind-merge`.

## Configuration Files

- **`.env` / `.env.local`**: Environment variable files. `.env.local` typically holds the `NEXT_PUBLIC_CONVEX_URL` for local development. Sensitive keys (like `OPENAI_API_KEY`) should be managed via the Convex dashboard. The `CONVEX_DEPLOYMENT` variable is used by `npx convex dev`.
- **`.eslintrc.json`**: Configuration file for ESLint, extending the standard Next.js core web vitals rules.
- **`.gitignore`**: Specifies intentionally untracked files that Git should ignore (e.g., `node_modules`, `.env*.local`, `.next`, `.vercel`).
- **`components.json`**: Configuration file for shadcn/ui, defining styling, component paths, and aliases.
- **`next.config.js`**: Configuration file for Next.js. Includes settings for ESLint and unoptimized images.
- **`package.json`**: Defines project metadata, scripts (`dev`, `build`, `start`, `lint`), and lists dependencies and devDependencies.
- **`postcss.config.js`**: Configuration file for PostCSS, primarily setting up Tailwind CSS and Autoprefixer plugins.
- **`tailwind.config.ts`**: Configuration file for Tailwind CSS. Defines theme customizations (colors, keyframes, animations), content paths, and plugins (`tailwindcss-animate`).
- **`tsconfig.json`**: Configuration file for TypeScript. Specifies compiler options, paths aliases (`@/*`), included files, and excluded directories.

## Documentation

- **`README.md`**: Provides an overview of the project, features, setup instructions for local development, deployment guide for Vercel, technology stack, and contribution guidelines.
- **`convexsetup.md`**: A supplementary guide specifically focused on setting up Convex for the project (installation, initialization, schema).

## Project Structure Overview

```
nextjs-convex-demo/
├── app/
│   ├── layout.tsx           # Main application layout
│   ├── page.tsx             # Main page component (renders Chat)
│   ├── providers.tsx        # Context providers (Convex, Theme, etc.)
│   └── globals.css          # Global styles and Tailwind directives
├── components/
│   ├── chat.tsx             # Core chat UI component
│   ├── chat-message.tsx     # Renders individual messages
│   ├── convex-chat-provider.tsx # Integrates Convex with useChat
│   ├── navbar.tsx           # Application navigation bar
│   ├── footer.tsx           # Application footer
│   └── ui/                  # Shadcn/ui components (toast.tsx, button.tsx, etc.)
├── convex/
│   ├── schema.ts            # Database schema definition
│   ├── chat.ts              # Chat archival logic
│   ├── directMessages.ts    # Saving AI responses
│   ├── init.ts              # Initial data seeding
│   ├── messages.ts          # Message query/mutation functions
│   ├── modelPreferences.ts  # AI model preference logic
│   ├── multiModelAI.ts      # Core AI interaction action
│   ├── openai.ts            # OpenAI action wrappers (re-exports)
│   ├── useOpenAI.ts         # Direct OpenAI interaction actions
│   └── _generated/          # Auto-generated Convex types and API (DO NOT EDIT)
├── hooks/
│   └── use-toast.ts         # Custom hook for toast notifications
├── lib/
│   └── utils.ts             # Utility functions (e.g., cn for classnames)
├── public/                  # Static assets (images, fonts, etc.)
├── .env.local               # Local environment variables (Convex URL)
├── .eslintrc.json           # ESLint configuration
├── .gitignore               # Git ignore rules
├── components.json          # Shadcn/ui configuration
├── next.config.js           # Next.js configuration
├── package.json             # Project dependencies and scripts
├── postcss.config.js        # PostCSS configuration (Tailwind)
├── tailwind.config.ts       # Tailwind CSS configuration
├── tsconfig.json            # TypeScript configuration
├── README.md                # Project overview and setup guide
├── convexsetup.md           # Convex-specific setup guide
├── filesjason.md            # Descriptions of project files (this file)
└── nextchatjsonprompt.md    # JSON prompt structure for the app
```
